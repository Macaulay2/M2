
i1 : setRandomSeed();

i2 : A = QQ[w,x,y,z]

o2 = A

o2 : PolynomialRing

i3 : U = matrix {{w,x},{y,z}}

o3 = | w x |
     | y z |

             2       2
o3 : Matrix A  <--- A

i4 : C = chainComplex U

      2      2
o4 = A  <-- A
             
     0      1

o4 : ChainComplex

i5 : L = HH_0 C

o5 = cokernel | w x |
              | y z |

                            2
o5 : A-module, quotient of A

i6 : f = -det U

o6 = x*y - w*z

o6 : A

i7 : f * L == 0

o7 = true

i8 : s = nullhomotopy (-f * id_C)

          2                     2
o8 = 1 : A  <----------------- A  : 0
               {1} | z  -x |
               {1} | -y w  |

o8 : ChainComplexMap

i9 : s * C.dd + C.dd * s == -f

o9 = true

i10 : V = s_0

o10 = {1} | z  -x |
      {1} | -y w  |

              2       2
o10 : Matrix A  <--- A

i11 : A = QQ[x,y,z];

i12 : f = x^3 + 3*y^3 - 2*y*z^2 + 5*z^3;

i13 : B = A/f;

i14 : m = ideal(x,y,z)

o14 = ideal (x, y, z)

o14 : Ideal of B

i15 : M = B^1/m^2;

i16 : F = resolution(M, LengthLimit=>8)

       1      6      9      9      9      9      9      9      9
o16 = B  <-- B  <-- B  <-- B  <-- B  <-- B  <-- B  <-- B  <-- B
                                                               
      0      1      2      3      4      5      6      7      8

o16 : ChainComplex

i17 : restrict1 = N -> coker(lift(presentation N,A) | f);

i18 : L = restrict1 cokernel F.dd_4;

i19 : C = res L;

i20 : U = C.dd_1;

              9       9
o20 : Matrix A  <--- A

i21 : print U
{4} | x2 0  -2yz+5z2 0     y2-5/2yz yz-5/2z2 -5/2yz   0        0      |
{4} | 0  x2 -3y2     xy    yz-5/2z2 0        yz-5/2z2 0        0      |
{4} | 0  xy x2       y2    0        0        0        yz-5/2z2 0      |
{5} | y  0  0        0     0        0        1/3x     0        -2y+5z |
{5} | -z y  x        0     0        -1/2x    0        0        0      |
{5} | 0  0  0        -1/3x 0        1/2y     -1/3z    0        0      |
{5} | 0  -z 0        0     -1/2x    0        -1/2x    0        3y     |
{5} | 0  0  -z       0     1/2y     0        1/2y     -1/2x    0      |
{5} | 0  0  0        1/3z  0        0        0        1/2y     x      |

i22 : s = nullhomotopy (-f * id_C);

i23 : V = s_0;

              9       9
o23 : Matrix A  <--- A

i24 : print V
{6} | -x  0  0   -3y2 -2yz+5z2 0         -2y2+5yz 0         0         |
{6} | 0   -x 0   -3yz -3y2     -3xy      -2yz+5z2 0         0         |
{6} | 0   y  -x  0    0        0         0        -2yz+5z2  0         |
{6} | 0   0  -3y 3xz  3xy      3x2       0        0         6yz-15z2  |
{6} | -3y 2z 0   3x2  0        6yz-15z2  2x2      -15yz     -15xz     |
{6} | 2z  0  -2x 0    2x2      -6y2      0        -4yz+10z2 0         |
{6} | 3y  0  0   -3x2 0        -6yz+15z2 0        -6y2+15yz -6xy+15xz |
{6} | 0   0  2z  0    0        0         2xy      2x2       -6y2      |
{6} | 0   0  0   -z2  -yz      -xz       -y2      -xy       -x2       |

i25 : U*V+f==0

o25 = true

i26 : V*U+f==0

o26 = true

i27 : matrixFactorization = M -> (
         B := ring M;
         f := (ideal B)_0;
         e := numgens B;
         F := resolution(M, LengthLimit => e+1);
         L := restrict1 cokernel F.dd_(e+1);
         C := res L;
         U := C.dd_1;
         s := nullhomotopy (-f * id_C);
         V := s_0;
         assert( U*V + f == 0 );
         assert( V*U + f == 0 );
         return (U,V));

i28 : time (U,V) = matrixFactorization(B^1/m^3);
     -- used 0.039071 seconds

i29 : U;

              15       15
o29 : Matrix A   <--- A

i30 : V;

              15       15
o30 : Matrix A   <--- A

i31 : F.dd_3 - F.dd_5 == 0

o31 = false

i32 : F.dd_4 - F.dd_6 == 0

o32 = false

i33 : F.dd_5 - F.dd_7 == 0

o33 = false

i34 : M = B^1/m^2;

i35 : G = resolution(M, LengthLimit => 8, Strategy => 0)

       1      6      9      9      9      9      9      9      9
o35 = B  <-- B  <-- B  <-- B  <-- B  <-- B  <-- B  <-- B  <-- B
                                                               
      0      1      2      3      4      5      6      7      8

o35 : ChainComplex

i36 : G.dd_3 - G.dd_5 == 0

o36 = true

i37 : G.dd_4 - G.dd_6 == 0

o37 = true

i38 : G.dd_5 - G.dd_7 == 0

o38 = true

i39 : M = B^1/m^3;

i40 : F = resolution(M, LengthLimit=>8)

       1      10      16      15      15      15      15      15      15
o40 = B  <-- B   <-- B   <-- B   <-- B   <-- B   <-- B   <-- B   <-- B
                                                                      
      0      1       2       3       4       5       6       7       8

o40 : ChainComplex

i41 : M' = restrict1 M;

i42 : C = res M'

       1      10      15      6
o42 = A  <-- A   <-- A   <-- A  <-- 0
                                     
      0      1       2       3      4

o42 : ChainComplex

i43 : K = ZZ/103; 

i44 : A = K[x,Degrees=>{5}];

i45 : B = A/(x^3);

i46 : M = B^1/(x^2);

i47 : N = B^1/(x);

i48 : H = Ext(M,N);

i49 : ring H

o49 = K[X , x]
         1

o49 : PolynomialRing

i50 : degree \ gens ring H

o50 = {{-2, -15}, {0, 5}}

o50 : List

i51 : S = ring H;

i52 : H

o52 = cokernel {0, 0}    | 0 x |
               {-1, -10} | x 0 |

                             2
o52 : S-module, quotient of S

i53 : A = K[x,y];

i54 : J = ideal(x^3,y^2);

o54 : Ideal of A

i55 : B = A/J;

i56 : N = cokernel matrix{{x^2,x*y}}

o56 = cokernel | x2 xy |

                             1
o56 : B-module, quotient of B

i57 : time H = Ext(N,N);
     -- used 0.007732 seconds

i58 : ring H

o58 = K[X ..X , x..y]
         1   2

o58 : PolynomialRing

i59 : S = ring H;

i60 : transpose vars S

o60 = {2, 2}  | X_1 |
      {2, 3}  | X_2 |
      {0, -1} | x   |
      {0, -1} | y   |

              4       1
o60 : Matrix S  <--- S

i61 : trim J

              2   3
o61 = ideal (y , x )

o61 : Ideal of A

i62 : H

o62 = cokernel {0, 0}   | y2 xy x2 0 0 0 0 0 0 0 0 X_1y X_1x 0   0   0 0 |
               {-1, -1} | 0  0  0  y x 0 0 0 0 0 0 0    0    X_1 0   0 0 |
               {-1, -1} | 0  0  0  0 0 y x 0 0 0 0 0    0    0   X_1 0 0 |
               {-1, -1} | 0  0  0  0 0 0 0 y x 0 0 0    0    0   X_1 0 0 |
               {-1, -1} | 0  0  0  0 0 0 0 0 0 y x 0    0    0   0   0 0 |
               {-2, -2} | 0  0  0  0 0 0 0 0 0 0 0 0    0    0   0   y x |

                             6
o62 : S-module, quotient of S

i63 : partSelector = predicate -> H -> (
         R := ring H;
         H' := prune image matrix {
             select(
                 apply(numgens H, i -> H_{i}),
                 f -> predicate first first degrees source f
                 )
             };
         H');

i64 : evenPart = partSelector even; oddPart = partSelector odd;

i66 : evenPart H

o66 = cokernel {0, 0}   | y2 xy x2 X_1y X_1x 0 0 |
               {-2, -2} | 0  0  0  0    0    y x |

                             2
o66 : S-module, quotient of S

i67 : oddPart H

o67 = cokernel {-1, -1} | y x 0 0 0 0 0 0 X_1 0   |
               {-1, -1} | 0 0 y x 0 0 0 0 0   X_1 |
               {-1, -1} | 0 0 0 0 y x 0 0 0   X_1 |
               {-1, -1} | 0 0 0 0 0 0 y x 0   0   |

                             4
o67 : S-module, quotient of S

i68 : print code(Ext,Module,Module)
-- code for method: Ext(Module,Module)
/Users/mike/src/M2/M2/Macaulay2/m2/ext.m2:89:39-179:3: --source code:
Ext(Module,Module) := Module => (M,N) -> (
  cacheModule := M; -- we have no way to tell whether N is younger than M, sigh
  cacheKey := (Ext,M,N);
  if cacheModule.cache#?cacheKey then return cacheModule.cache#cacheKey;
  B := ring M;
  if B =!= ring N
  then error "expected modules over the same ring";
  if not isCommutative B
  then error "'Ext' not implemented yet for noncommutative rings.";
  if not isHomogeneous B
  then error "'Ext' received modules over an inhomogeneous ring";
  if not isHomogeneous N or not isHomogeneous M
  then error "'Ext' received an inhomogeneous module";
  if N == 0 or M == 0 then return cacheModule.cache#cacheKey = B^0;
  p := presentation B;
  A := ring p;
  I := ideal mingens ideal p;
  n := numgens A;
  c := numgens I;
  if c =!= codim B 
  then error "total Ext available only for complete intersections";
  f := apply(c, i -> I_i);
  pM := lift(presentation M,A);
  pN := lift(presentation N,A);
  M' := cokernel ( pM | p ** id_(target pM) );
  N' := cokernel ( pN | p ** id_(target pN) );
  assert isHomogeneous M';
  assert isHomogeneous N';
  C := complete resolution M';
  X := getSymbol "X";
  K := coefficientRing A;
  S := K(monoid [X_1 .. X_c, toSequence A.generatorSymbols,
    Degrees => {
      apply(0 .. c-1, i -> prepend(-2, - degree f_i)),
      apply(0 .. n-1, j -> prepend( 0,   degree A_j))
      }]);
  -- make a monoid whose monomials can be used as indices
  Rmon := monoid [X_1 .. X_c,Degrees=>{c:{2}}];
  -- make group ring, so 'basis' can enumerate the monomials
  R := K Rmon;
  -- make a hash table to store the blocks of the matrix
  blks := new MutableHashTable;
  blks#(exponents 1_Rmon) = C.dd;
  scan(0 .. c-1, i -> 
       blks#(exponents Rmon_i) = nullhomotopy (- f_i*id_C));
  -- a helper function to list the factorizations of a monomial
  factorizations := (gamma) -> (
    -- Input: gamma is the list of exponents for a monomial
    -- Return a list of pairs of lists of exponents showing the
    -- possible factorizations of gamma.
    if gamma === {} then { ({}, {}) }
    else (
      i := gamma#-1;
      splice apply(factorizations drop(gamma,-1), 
        (alpha,beta) -> apply (0..i, 
             j -> (append(alpha,j), append(beta,i-j))))));
  scan(4 .. length C + 1, 
    d -> if even d then (
      scan( flatten \ exponents \ leadMonomial \ first entries basis(d,R), 
        gamma -> (
          s := - sum(factorizations gamma,
            (alpha,beta) -> (
              if blks#?alpha and blks#?beta
              then blks#alpha * blks#beta
              else 0));
          -- compute and save the nonzero nullhomotopies
          if s != 0 then blks#gamma = nullhomotopy s;
          ))));
  -- make a free module whose basis elements have the right degrees
  spots := C -> sort select(keys C, i -> class i === ZZ);
  Cstar := S^(apply(spots C,
      i -> toSequence apply(degrees C_i, d -> prepend(i,d))));
  -- assemble the matrix from its blocks.
  -- We omit the sign (-1)^(n+1) which would ordinarily be used,
  -- which does not affect the homology.
  toS := map(S,A,apply(toList(c .. c+n-1), i -> S_i),
    DegreeMap => prepend_0);
  Delta := map(Cstar, Cstar, 
    transpose sum(keys blks, m -> S_m * toS sum blks#m),
    Degree => { -1, degreeLength A:0 });
  DeltaBar := Delta ** (toS ** N');
  if debugLevel > 10 then (
       assert isHomogeneous DeltaBar;
       assert(DeltaBar * DeltaBar == 0);
       stderr << describe ring DeltaBar <<endl;
       stderr << toExternalString DeltaBar << endl;
       );
  -- now compute the total Ext as a single homology module
  tot := minimalPresentation homology(DeltaBar,DeltaBar);
  cacheModule.cache#cacheKey = tot;
  tot)

i69 : A = K[x,y,z];

i70 : J = trim ideal(x^3,y^4,z^5)

              3   4   5
o70 = ideal (x , y , z )

o70 : Ideal of A

i71 : B = A/J;

i72 : f = random (B^3, B^{-2,-3})

o72 = | -28x2-31xy-24y2-4xz-49yz-19z2  -44x2y-4xy2-49y3+30x2z-51xyz+51y2z+23xz2-19yz2+42z3 |
      | 47x2-6xy-49y2+9xz+47yz-25z2    16x2y-9xy2-31y3+34x2z-2xyz-16y2z-23xz2+14yz2+50z3   |
      | -36x2-44xy-18y2+11xz-18yz+21z2 -36x2y+28xy2-21y3-x2z-8xyz+6y2z+37xz2+27yz2+43z3    |

              3       2
o72 : Matrix B  <--- B

i73 : f_{1}

o73 = | -44x2y-4xy2-49y3+30x2z-51xyz+51y2z+23xz2-19yz2+42z3 |
      | 16x2y-9xy2-31y3+34x2z-2xyz-16y2z-23xz2+14yz2+50z3   |
      | -36x2y+28xy2-21y3-x2z-8xyz+6y2z+37xz2+27yz2+43z3    |

              3       1
o73 : Matrix B  <--- B

i74 : M = cokernel f;

i75 : time P = Ext(M,B^1/(x,y,z));
     -- used 0.196473 seconds

i76 : S = ring P;

i77 : transpose vars S

o77 = {2, 3}  | X_1 |
      {2, 4}  | X_2 |
      {2, 5}  | X_3 |
      {0, -1} | x   |
      {0, -1} | y   |
      {0, -1} | z   |

              6       1
o77 : Matrix S  <--- S

i78 : R = K[X_1..X_3,Degrees => {{-2,-3},{-2,-4},{-2,-5}}];

i79 : phi = map(R,S,{X_1,X_2,X_3,0,0,0})

o79 = map (R, S, {X , X , X , 0, 0, 0})
                   1   2   3

o79 : RingMap R <--- S

i80 : P = prune (phi ** P);

i81 : transpose vars ring P

o81 = {2, 3} | X_1 |
      {2, 4} | X_2 |
      {2, 5} | X_3 |

              3       1
o81 : Matrix R  <--- R

i82 : evenPart P

o82 = cokernel {-2, -7}  | 0   0   0   0   0   0   0   0   0   0    |
               {-2, -7}  | 0   0   0   0   0   0   0   0   0   0    |
               {-2, -7}  | 0   0   0   0   0   0   0   0   0   0    |
               {-2, -7}  | 0   0   0   0   0   0   0   0   0   0    |
               {0, 0}    | X_3 X_2 X_1 0   0   0   0   0   0   0    |
               {0, 0}    | 0   0   0   X_3 X_2 X_1 0   0   0   0    |
               {0, 0}    | 0   0   0   0   0   0   X_3 X_2 X_1 0    |
               {-4, -11} | 0   0   0   0   0   0   0   0   0   X_1  |
               {-4, -10} | 0   0   0   0   0   0   0   0   0   0    |
               {-4, -10} | 0   0   0   0   0   0   0   0   0   -X_2 |

                             10
o82 : R-module, quotient of R

i83 : oddPart P

o83 = cokernel {-1, -3} | X_2 X_1 0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   X_1 0   0   |
               {-3, -9} | 0   0   0   0   0   0   X_1 0   |
               {-3, -9} | 0   0   0   0   0   0   0   X_1 |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-1, -2} | 0   0   X_3 X_2 X_1 0   0   0   |

                             11
o83 : R-module, quotient of R

i84 : changeRing = H -> (
         S := ring H;
         K := coefficientRing S;
         degs := select(degrees source vars S,
              d -> 0 != first d);
         R := K[X_1 .. X_#degs, Degrees => degs];
         phi := map(R,S,join(gens R,(numgens S - numgens R):0));
         prune (phi ** H)
         );

i85 : Ext(Module,Ring) := (M,k) -> (
         B := ring M;
         if ideal k != ideal vars B
         then error "expected the residue field of the module";
         changeRing Ext(M,coker vars B)
         );

i86 : use B;

i87 : k = B/(x,y,z);

i88 : use B;

i89 : P = Ext(M,k);

i90 : time oddPart P
     -- used 0.001676 seconds

o90 = cokernel {-1, -3} | X_2 X_1 0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   X_1 0   0   |
               {-3, -9} | 0   0   0   0   0   0   X_1 0   |
               {-3, -9} | 0   0   0   0   0   0   0   X_1 |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-3, -9} | 0   0   0   0   0   0   0   0   |
               {-1, -2} | 0   0   X_3 X_2 X_1 0   0   0   |

                                               11
o90 : K[X ..X ]-module, quotient of (K[X ..X ])
         1   3                          1   3

i91 : Ext(Ring,Module) := (k,M) -> (
         B := ring M;
         if ideal k != ideal vars B
         then error "expected the residue field of the module";
         changeRing Ext(coker vars B,M)
         );

i92 : time I = Ext(k,M);
     -- used 0.807293 seconds

i93 : evenPart I

o93 = cokernel {0, 6} | 11X_2  11X_1  |
               {0, 6} | -16X_2 -16X_1 |
               {0, 6} | -44X_2 -44X_1 |
               {0, 6} | 32X_2  32X_1  |
               {0, 6} | -41X_2 -41X_1 |
               {0, 6} | 11X_2  11X_1  |
               {0, 6} | X_2    X_1    |

                                               7
o93 : K[X ..X ]-module, quotient of (K[X ..X ])
         1   3                          1   3

i94 : oddPart I

o94 = cokernel {-1, 3} | 0      0      0      0   0   X_1    0      0      0      0   |
               {-1, 4} | -41X_1 21X_1  -4X_1  0   0   X_2    21X_2  -4X_2  -41X_2 0   |
               {-1, 4} | -44X_1 22X_1  -9X_1  0   0   -40X_2 22X_2  -9X_2  -44X_2 0   |
               {-1, 4} | -14X_1 37X_1  4X_1   0   0   -18X_2 37X_2  4X_2   -14X_2 0   |
               {-1, 4} | 17X_1  -22X_1 49X_1  0   0   -45X_2 -22X_2 49X_2  17X_2  0   |
               {-1, 4} | -28X_1 -41X_1 -13X_1 0   0   16X_2  -41X_2 -13X_2 -28X_2 0   |
               {-1, 4} | 37X_1  45X_1  23X_1  0   0   17X_2  45X_2  23X_2  37X_2  0   |
               {-1, 4} | X_1    0      0      0   0   0      0      0      X_2    0   |
               {-1, 4} | 0      X_1    0      0   0   0      X_2    0      0      0   |
               {-1, 4} | 0      0      X_1    0   0   0      0      X_2    0      0   |
               {-1, 5} | 0      0      0      X_1 0   3X_3   4X_3   -16X_3 14X_3  0   |
               {-1, 5} | 0      0      0      0   X_1 -17X_3 18X_3  13X_3  -17X_3 0   |
               {-1, 5} | 0      0      0      0   0   -3X_3  -13X_3 -15X_3 -30X_3 X_1 |

                                               13
o94 : K[X ..X ]-module, quotient of (K[X ..X ])
         1   3                          1   3

i95 : T = ZZ[t,u,Inverses=>true,MonomialOrder=>RevLex,Weights=>{-3,-1}];

i96 : poincareSeries2 = M -> (
         B := ring M;
         k := B/ideal vars B;
         P := Ext(M,k);
         h := hilbertSeries P;
         T':= degreesRing P;
         substitute(h, {T'_0=>t^-1,T'_1=>u^-1})
         );

i97 : poincareSeries1 = M -> (
         substitute(poincareSeries2 M, {u=>1_T})
         );

i98 : A' = K[x,y,z];

i99 : B' = A'/(x^2,y^2,z^3);

i100 : C' = res(B'^1/(x,y,z), LengthLimit => 6)

         1       3       6       10       15       21       28
o100 = B'  <-- B'  <-- B'  <-- B'   <-- B'   <-- B'   <-- B'
                                                           
       0       1       2       3        4        5        6

o100 : ChainComplex

i101 : M' = coker transpose C'.dd_5

o101 = cokernel {-5} | -y 0   0  0  z  0 0 0  0 0  0  0 0  0 0 |
                {-5} | -x -y  0  0  0  z 0 0  0 0  0  0 0  0 0 |
                {-5} | 0  x   -y 0  0  0 z 0  0 0  0  0 0  0 0 |
                {-5} | 0  0   x  -y 0  0 0 z  0 0  0  0 0  0 0 |
                {-5} | 0  0   0  -x 0  0 0 0  z 0  0  0 0  0 0 |
                {-5} | 0  0   0  0  y  0 0 0  0 0  0  0 0  0 0 |
                {-5} | 0  0   0  0  -x y 0 0  0 0  0  0 0  0 0 |
                {-5} | 0  0   0  0  0  x y 0  0 0  0  0 0  0 0 |
                {-5} | 0  0   0  0  0  0 x y  0 0  0  0 0  0 0 |
                {-5} | 0  0   0  0  0  0 0 -x y 0  0  0 0  0 0 |
                {-5} | 0  0   0  0  0  0 0 0  x 0  0  0 0  0 0 |
                {-6} | 0  0   0  0  0  0 0 0  0 -y 0  z 0  0 0 |
                {-6} | 0  0   0  0  0  0 0 0  0 x  -y 0 z  0 0 |
                {-6} | 0  0   0  0  0  0 0 0  0 0  -x 0 0  z 0 |
                {-6} | z2 0   0  0  0  0 0 0  0 0  0  y 0  0 0 |
                {-6} | 0  -z2 0  0  0  0 0 0  0 0  0  x y  0 0 |
                {-6} | 0  0   z2 0  0  0 0 0  0 0  0  0 -x y 0 |
                {-6} | 0  0   0  z2 0  0 0 0  0 0  0  0 0  x 0 |
                {-7} | 0  0   0  0  0  0 0 0  0 z2 0  0 0  0 y |
                {-7} | 0  0   0  0  0  0 0 0  0 0  z2 0 0  0 x |
                {-7} | 0  0   0  0  0  0 0 0  0 0  0  0 0  0 z |

                                21
o101 : B'-module, quotient of B'

i102 : poincareSeries2 M'

         -7     -6      -5      -6       -5       -4     2 -5      2 -4      2 -3      2 -2     3 -4      3 -3      3 -2     3 -1     4 -3     4 -2      4 -1      4    5 -2     5 -1     5      5     6 4     7 5    8 4     8 6     9 5    9 7     10 6    11 7
       3u   + 7u   + 11u   + t*u   + 5t*u   + 9t*u   - 6t u   - 14t u   - 22t u   - 11t u   - 2t u   - 10t u   - 18t u   - 9t u   + 3t u   + 7t u   + 11t u   + 15t  + t u   + 5t u   + 9t  + 13t u + t u  + 3t u  - t u  + 3t u  - 3t u  + t u  - 3t  u  - t  u
o102 = ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                                                                                2 3       2 2 2
                                                                                                                          (1 - t u )(1 - t u )

o102 : Expression of class Divide

i103 : p = poincareSeries1 M

                  2     3      4    5     6    7
       3 + 2t - 5t  + 4t  + 12t  + t  - 4t  - t
o103 = -----------------------------------------
                      2       2       2
                (1 - t )(1 - t )(1 - t )

o103 : Expression of class Divide

i104 : load "simplify.m2"

i105 : simplify p

                 2     3     4     5    6
       3 - t - 4t  + 8t  + 4t  - 3t  - t
o105 = ----------------------------------
                       2       3
                (1 + t) (1 - t)

o105 : Expression of class Divide

i106 : T' = QQ[t,Inverses=>true,MonomialOrder=>RevLex,Weights=>{-1}];

i107 : expansion = (n,q) -> (
           t := T'_0;
           rho := map(T',T,{t,1});
           num := rho value numerator q;
           den := rho value denominator q;
           n = n + first degree den;
           n = max(n, first degree num + 1);
           (num + t^n) // den
           );

i108 : expansion(20,p)

                  2      3      4      5      6      7      8      9      10       11       12       13       14       15       16       17       18       19       20
o108 = 3 + 2t + 4t  + 10t  + 15t  + 25t  + 32t  + 46t  + 55t  + 73t  + 84t   + 106t   + 119t   + 145t   + 160t   + 190t   + 207t   + 241t   + 260t   + 298t   + 319t

o108 : T'

i109 : psi = map(K,B)

o109 = map (K, B, {0, 0, 0})

o109 : RingMap K <--- B

i110 : apply(10, i -> rank (psi ** Ext^i(M,coker vars B)))

o110 = {3, 2, 4, 10, 15, 25, 32, 46, 55, 73}

o110 : List

i111 : use T;

i112 : complexity = M -> dim Ext(M,coker vars ring M);

i113 : complexity M

o113 = 3

i114 : k = coker vars ring H;

i115 : prune Hom(k,H)

o115 = 0

o115 : K[X ..X , x..y]-module
          1   2

i116 : criticalDegree = M -> (
          B := ring M;
          k := B / ideal vars B;
          P := Ext(M,k);
          k  = coker vars ring P;
          - min ( first \ degrees source gens prune Hom(k,P))
          );

i117 : criticalDegree M

o117 = 1

i118 : criticalDegree M'

o118 = 5

i119 : supportVarietyIdeal = M -> (
          B := ring M;
          k := B/ideal vars B;
          ann Ext(M,k)
          );

i120 : K'' = ZZ/7;

i121 : A'' = K''[x,y,z];

i122 : J'' = ideal(x^7,y^7,z^7);

o122 : Ideal of A''

i123 : B'' = A''/J'';

i124 : scan((1,1) .. (3,3), (r,d) -> (
               V := cokernel random (B''^r,B''^{-d});
               << "------------------------------------------------------------------"
               << endl
               << "V = " << V << endl
               << "support variety ideal = "
               << timing supportVarietyIdeal V
               << endl))
------------------------------------------------------------------
V = cokernel | 2x+z |
support variety ideal = ideal (X , X  + 3X )
                                2   1     3
                        -- .019386 seconds
------------------------------------------------------------------
V = cokernel | 3xy-y2+3xz-3yz+3z2 |
support variety ideal = ideal ()
                        -- .125895 seconds
------------------------------------------------------------------
V = cokernel | 3x2y-2xy2-3y3-x2z+3xyz-3y2z+3xz2 |
support variety ideal = ideal ()
                        -- .159221 seconds
------------------------------------------------------------------
V = cokernel | 3x-2y  |
             | x-3y+z |
support variety ideal = ideal(X  + 3X )
                               2     3
                        -- .026892 seconds
------------------------------------------------------------------
V = cokernel | -2xy+2xz-3yz+2z2       |
             | 3x2+2xy+3y2+xz-2yz+3z2 |
support variety ideal = ideal ()
                        -- .075065 seconds
------------------------------------------------------------------
V = cokernel | 3xyz-y2z+3xz2-2yz2+z3           |
             | 2xy2+2y3+2x2z-xyz+3xz2-3yz2+2z3 |
support variety ideal = ideal ()
                        -- .173907 seconds
------------------------------------------------------------------
V = cokernel | -3x+3y-2z |
             | -3x+2y    |
             | 2x-y-3z   |
support variety ideal = ideal(X  + 2X  - X )
                               1     2    3
                        -- .077985 seconds
------------------------------------------------------------------
V = cokernel | -xy+2y2+xz-3yz-3z2 |
             | -3xy+y2-xz         |
             | -xy+3y2-xz+yz+3z2  |
support variety ideal = ideal ()
                        -- .245207 seconds
------------------------------------------------------------------
V = cokernel | 3x2y-xy2-3y3-xyz-2xz2+2yz2                 |
             | x3+3x2y-xy2-2y3+3x2z+2xyz-y2z+3xz2+3yz2-z3 |
             | 3x3-3x2y-2xy2+y3-3x2z+2xyz-y2z+xz2+3yz2    |
support variety ideal = ideal ()
                        -- .216556 seconds

i125 : bassSeries2 = M -> (
          B := ring M;
          k := B/ideal vars B;
          I := Ext(k,M);
          h := hilbertSeries I;
          T':= degreesRing I;
          substitute(h, {T'_0=>t^-1, T'_1=>u})
          );

i126 : bassSeries1 = M -> (
          substitute(bassSeries2 M, {u=>1_T})
          );

i127 : use B;

i128 : L = B^1/(x,y,z);

i129 : p = poincareSeries2 L

                        2 2    3 3
           1 + 3t*u + 3t u  + t u
o129 = ------------------------------
             2 5       2 4       2 3
       (1 - t u )(1 - t u )(1 - t u )

o129 : Expression of class Divide

i130 : b = bassSeries2 L

                  -1     2 -2    3 -3
          1 + 3t*u   + 3t u   + t u
o130 = ---------------------------------
             2 -5       2 -4       2 -3
       (1 - t u  )(1 - t u  )(1 - t u  )

o130 : Expression of class Divide

i131 : b2 = bassSeries2 M

         6      3       4       5    2 2    2 3     3     3      3 2    4 -1     5 -3
       7u  + t*u  + 9t*u  + 3t*u  - t u  - t u  - 4t  - 3t u - 3t u  + t u   + 3t u
o131 = ------------------------------------------------------------------------------
                                    2 -5       2 -4       2 -3
                              (1 - t u  )(1 - t u  )(1 - t u  )

o131 : Expression of class Divide

i132 : b1 = bassSeries1 M;

i133 : simplify b1

                  2     3     4
       7 + 6t - 8t  - 2t  + 3t
o133 = ------------------------
                  2       3
           (1 + t) (1 - t)

o133 : Expression of class Divide

i134 : ext = (M,N) -> changeRing Ext(M,N);

i135 : use B;

i136 : N = B^1/(x^2 + z^2,y^3);

i137 : time rH = ext(M,N);
     -- used 1.22413 seconds

i138 : evenPart rH

o138 = cokernel {0, 1}   | X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0      0   0     0   0   |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0      0   0     0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1 0   0   0   0   -46X_2 0   33X_2 0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1 0   0   0   34X_2  0   8X_2  0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1 0   0   26X_2  0   0     0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1 0   -15X_2 0   -6X_2 0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1 -47X_2 0   10X_2 0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_2    X_1 0     0   0   |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   X_2   X_1 0   |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0     0   X_1 |

                                                17
o138 : K[X ..X ]-module, quotient of (K[X ..X ])
          1   3                          1   3

i139 : oddPart rH

o139 = cokernel {-1, -1} | X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   -18X_3 0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   X_2 X_1 0   0   0   0   0   0   0   0   0   0   9X_3   0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   0   0   X_2 X_1 0   0   0   0   0   0   0   0   24X_3  0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   0   0   0   0   X_2 X_1 0   0   0   0   0   0   -31X_3 0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   0   0   0   0   0   0   X_2 X_1 0   0   0   0   38X_3  0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   0   0   0   0   0   0   0   0   X_2 X_1 0   0   47X_3  0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   0   0   0   0   0   0   0   0   0   0   X_2 X_1 47X_3  0   0   0   0   0   0   0   0   |
                {-1, -1} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3    X_2 X_1 0   0   0   0   0   0   |
                {-3, -7} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0   X_1 0   0   0   0   0   |
                {-3, -6} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0   0   X_1 0   0   0   0   |
                {-3, -6} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0   0   0   X_1 0   0   0   |
                {-3, -6} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0   0   0   0   X_1 0   0   |
                {-3, -6} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0   0   0   0   0   X_1 0   |
                {-3, -6} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0   0   0   0   0   0   X_1 |

                                                14
o139 : K[X ..X ]-module, quotient of (K[X ..X ])
          1   3                          1   3

i140 : N' = B^1/(x^2 + z^2,y^3 - 2*z^3);

i141 : time rH' = ext(M,N');
     -- used 1.12031 seconds

i142 : evenPart rH'

o142 = cokernel {0, 1}   | X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 1}   | 0   0   X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {0, 2}   | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_3 X_2 X_1 0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   44X_1  45X_2 -29X_1 24X_2  -34X_1 -34X_2 -43X_1 0   0   23X_2  -2X_1  -27X_2 -2X_1 7X_2   40X_1 -20X_2 19X_1  0   0   -18X_2 19X_1  -35X_1X_3 48X_1X_3  31X_1X_3       2X_1X_3   -50X_1X_3      X_2^2-44X_1X_3 |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1    10X_2 13X_1  5X_2   -X_1   22X_2  -18X_1 0   0   24X_2  -7X_1  18X_2  49X_1 -43X_2 35X_1 0      36X_1  0   0   -16X_2 34X_1  X_1X_3    31X_1X_3  5X_1X_3        -3X_1X_3  X_2^2-28X_1X_3 -37X_1X_3      |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   14X_1  18X_2 -43X_1 21X_2  40X_1  -51X_2 7X_1   0   0   -29X_2 -51X_1 17X_2  39X_1 -32X_2 30X_1 17X_2  6X_1   0   0   3X_2   -18X_1 X_1X_3    -13X_1X_3 X_2^2+25X_1X_3 -51X_1X_3 -39X_1X_3      -8X_1X_3       |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   -24X_1 34X_2 -38X_1 -12X_2 29X_1  -33X_2 0      0   0   40X_2  -40X_1 21X_2  -2X_1 35X_2  17X_1 2X_2   -38X_1 0   0   -13X_2 23X_1  X_1X_3    X_2^2     0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_2 X_1 0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   X_1    -3X_2 0      6X_2   0      40X_2  0      0   0   31X_2  0      -31X_2 0     25X_2  0     -36X_2 0      0   0   -50X_2 0      0         0         0              X_2^2     0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      X_2   X_1    0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      X_2    X_1    0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      X_2    X_1    0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      X_2 X_1 0      0      0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   X_2    X_1    0      0     0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      X_2    X_1   0      0     0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     X_2    X_1   0      0      0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     X_2    X_1    0   0   0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      X_2 X_1 0      0      0         0         0              0         0              0              |
                {-2, -4} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   X_2    X_1    0         0         0              0         0              0              |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      -28X_1    -25X_1    20X_1          -39X_1    10X_1          -49X_1         |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      15X_1     33X_1     -19X_1         -48X_1    18X_1          22X_1          |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      -17X_1    -43X_1    19X_1          -45X_1    -26X_1         16X_1          |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      15X_1     45X_1     -29X_1         -14X_1    -40X_1         -16X_1         |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      -49X_1    -37X_1    19X_1          49X_1     -23X_1         -17X_1         |
                {-4, -9} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      10X_1     6X_1      24X_1          -46X_1    4X_1           27X_1          |
                {-4, -8} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         -20X_2    -13X_2         -45X_2    45X_2          -47X_2         |
                {-4, -8} | 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0     0      0      0      0      0      0   0   0      0      0      0     0      0     0      0      0   0   0      0      0         0         50X_2          41X_2     31X_2          18X_2          |

                                                33
o142 : K[X ..X ]-module, quotient of (K[X ..X ])
          1   3                          1   3

i143 : oddPart rH'

o143 = cokernel {-1, -2} | X_2 X_1 0   0   0   0   0   0   0      0      0      0      0      0      |
                {-1, -2} | 0   0   X_2 X_1 0   0   0   0   0      0      0      0      0      0      |
                {-1, -2} | 0   0   0   0   X_2 X_1 0   0   0      0      0      0      0      0      |
                {-1, -2} | 0   0   0   0   0   0   X_2 X_1 0      0      0      0      0      0      |
                {-3, -7} | 0   0   0   0   0   0   0   0   X_1    0      0      0      0      0      |
                {-3, -7} | 0   0   0   0   0   0   0   0   0      0      0      0      X_1    0      |
                {-3, -7} | 0   0   0   0   0   0   0   0   0      X_1    0      0      0      0      |
                {-3, -7} | 0   0   0   0   0   0   0   0   0      0      X_1    0      0      0      |
                {-3, -7} | 0   0   0   0   0   0   0   0   0      0      0      X_1    0      0      |
                {-3, -7} | 0   0   0   0   0   0   0   0   0      0      0      0      0      X_1    |
                {-3, -6} | 0   0   0   0   0   0   0   0   37X_2  31X_2  15X_2  -10X_2 -35X_2 -42X_2 |
                {-3, -6} | 0   0   0   0   0   0   0   0   11X_2  -41X_2 -14X_2 -7X_2  -34X_2 -44X_2 |
                {-3, -6} | 0   0   0   0   0   0   0   0   17X_2  12X_2  26X_2  -28X_2 -43X_2 -12X_2 |
                {-3, -6} | 0   0   0   0   0   0   0   0   -24X_2 50X_2  31X_2  40X_2  9X_2   19X_2  |
                {-3, -6} | 0   0   0   0   0   0   0   0   -41X_2 -30X_2 -24X_2 -28X_2 -37X_2 -47X_2 |
                {-3, -6} | 0   0   0   0   0   0   0   0   -22X_2 -36X_2 48X_2  44X_2  25X_2  23X_2  |

                                                16
o143 : K[X ..X ]-module, quotient of (K[X ..X ])
          1   3                          1   3

i144 : extgenSeries2 = (M,N) -> (
          H := ext(M,N);
          h := hilbertSeries H;
          T':= degreesRing H;
          substitute(h, {T'_0=>t^-1,T'_1=>u^-1})
          );

i145 : extgenSeries1 = (M,N) -> (
          substitute(extgenSeries2(M,N), {u=>1_T})
          );

i146 : time extgenSeries2(M,N)
     -- used 0.00583 seconds

         -2    -1            2      2 2     2 3     2 4     3 4     3 5     3 6    3 7     4 5     4 6    4 7     4 8    4 9     5 8     5 9     6 10     6 11    6 12    7 13
       8u   + u   + 8t*u - 8t u - 9t u  - 9t u  + 7t u  - 8t u  - 8t u  + 4t u  + t u  + 8t u  + 9t u  + t u  - 2t u  + t u  + 8t u  - 4t u  - 8t u   + 2t u   - t u   - t u
o146 = -----------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                                  2 5       2 4       2 3
                                                                            (1 - t u )(1 - t u )(1 - t u )

o146 : Expression of class Divide

i147 : g=time extgenSeries1(M,N)
     -- used 0.067629 seconds

                   2      3      4     5     6    7
       9 + 8t - 19t  - 11t  + 17t  + 4t  - 7t  - t
o147 = --------------------------------------------
                       2       2       2
                 (1 - t )(1 - t )(1 - t )

o147 : Expression of class Divide

i148 : simplify g

                 2     3    4
       9 - t - 9t  + 6t  + t
o148 = ----------------------
                         2
           (1 + t)(1 - t)

o148 : Expression of class Divide

i149 : time extgenSeries2(M,N')
     -- used 0.011802 seconds

         -2     -1       2     2      2 2     2 3      2 4     3 5     3 6     3 7     4 5     4 6     4 7     4 8     4 9     5 9     5 10     6 10      6 11     6 12
       7u   + 2u   + 4t*u  - 7t u - 9t u  - 9t u  + 16t u  - 4t u  + 2t u  + 6t u  + 7t u  + 9t u  - 5t u  - 9t u  + 6t u  + 4t u  - 6t u   - 7t u   + 11t u   - 6t u
o149 = ----------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                              2 5       2 4       2 3
                                                                        (1 - t u )(1 - t u )(1 - t u )

o149 : Expression of class Divide

i150 : g'=time extgenSeries1(M,N')
     -- used 0.008228 seconds

                  2     3     4     5     6
       9 + 4t - 9t  + 4t  + 8t  - 2t  - 2t
o150 = ------------------------------------
                   2       2       2
             (1 - t )(1 - t )(1 - t )

o150 : Expression of class Divide

i151 : simplify g'

                  2     3     5
       9 - 5t - 4t  + 8t  - 2t
o151 = ------------------------
                  2       3
           (1 + t) (1 - t)

o151 : Expression of class Divide

i152 : complexityPair = (M,N) -> dim ext(M,N);

i153 : time complexityPair(M,N)
     -- used 0.002071 seconds

o153 = 2

i154 : time complexityPair(M,N')
     -- used 0.003015 seconds

o154 = 3

i155 : supportVarietyPairIdeal = (M,N) -> ann ext(M,N);

i156 : time supportVarietyPairIdeal(M,N)
     -- used 0.079569 seconds

o156 = ideal X
              1

o156 : Ideal of K[X ..X ]
                   1   3

i157 : time supportVarietyPairIdeal(M,N')
     -- used 0.03777 seconds

o157 = ideal ()

o157 : Ideal of K[X ..X ]
                   1   3

i158 : 
