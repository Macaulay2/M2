# @configure_input@
include ../../include/config.Makefile
VPATH = @srcdir@

## here is the list of those package files to install with Macaulay2
PACKAGES = Macaulay2
PACKAGES += Style
PACKAGES += PrimaryDecomposition
PACKAGES += CacheFileName
PACKAGES += ConvexHulls
#PACKAGES += Dmodules
PACKAGES += Elimination
PACKAGES += FirstPackage
PACKAGES += GenericInitialIdeal
PACKAGES += Markov
PACKAGES += minimal
PACKAGES += Points
PACKAGES += PackageTemplate
PACKAGES += SimplicialComplexes
PACKAGES += LLLBases

# PACKAGES += SchurRings
##

RemakeAllDocumentation = false
IgnoreExampleErrors = false

ARGS := , MakeLinks => false
ARGS += , IgnoreExampleErrors => $(IgnoreExampleErrors)
ARGS += , RemakeAllDocumentation => $(RemakeAllDocumentation)
ARGS += , MakeInfo => true

ifeq ($(ENCAP),yes)
ARGS += , Encapsulate => true
else
ARGS += , Encapsulate => false
endif

ARGS1 := $(ARGS), PackagePrefix => \"$(prefix)/\"
ARGS2 := $(ARGS), PackagePrefix => \"$(encapdir)/\"

install ::
	@ for i in $(PACKAGES) ; \
	  do ( \
	      if [ "$$i" = Macaulay2 ] ; \
	      then \
		  set -x ; \
		  ../bin/M2 -q --stop \
		    --prefix $(encapdir) \
		    -e errorDepth=0 \
		    -e "installPackage(\"$$i\" $(ARGS1))" \
		    -e "exit 0" ; \
	      else \
		  set -x ; \
		  ../bin/M2 -q --stop \
		    --prefix $(encapdir) \
		    -e errorDepth=0 \
		    -e "installPackage(\"$$i\" $(ARGS2))" \
		    -e "exit 0" ; \
	      fi ; \
	     ) || exit 1 ; \
	done

clean::; rm -rf tmp *.installed

Dmodules.installed :: @srcdir@/Dmodules/*.m2

# ./tmp is used by examples in CacheFileName.m2
CacheFileName.installed : tmp
tmp : ; mkdir tmp

clean check distclean ::; $(MAKE) -C ComputationsBook $@
Makefile: Makefile.in; cd ../..; ./config.status Macaulay2/packages/Makefile
distclean::clean
distclean::; rm -f Makefile

# Local Variables:
# compile-command: "make -C $M2BUILDDIR/Macaulay2/packages "
# End:
