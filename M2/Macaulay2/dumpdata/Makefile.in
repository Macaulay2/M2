# @configure_input@
.PHONY : all clean distclean install check default
default: all check
include ../../include/config.Makefile
VPATH = @srcdir@
CFLAGS += -O0
all::
check::
checkit: checkit.o libdump.a
map.o: map.h file.h std.h warning.h
map.o: map-solaris.c map-linux.c map-macosx.c
dumpdata.o: dumpdata.h map.h warning.h std.h maputil.h
maputil.o: maputil.h map.h
checkit.o: dumpdata.h std.h
file.o: std.h
warning.o: warning.h std.h
gdb: checkit; gdb checkit
TAGS:; etags *.h *.c
clean::; rm -f *.o checkit core check-data *.a libdump.a
LIBS :=
# LIBS += mmap.o
# LIBS += write.o
$(LIBS): /usr/lib/libc.a; $(AR) x $< $@	
libdump.a: libdump.a(file.o warning.o map.o dumpdata.o maputil.o printmaps.o $(LIBS))
	ranlib libdump.a

ifneq "$(DUMPDATA)" "no"
all:: checkit
check:: test1
endif

test1: checkit
	./checkit dump "hi there"
	./checkit load "look!"
	touch "$@"
debug1:; gdb --args ./checkit dump "hi there"
debug2:; gdb --args ./checkit load "look!"
clean ::; rm -f "$@"

distclean : clean
	rm -f Makefile
Makefile : Makefile.in
	cd ../..; ./config.status Macaulay2/dumpdata/Makefile
all::testprintmaps
	./$<
testprintmaps:libdump.a
