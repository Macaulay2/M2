# @configure_input@
# FULLDEBUG = TRUE
include ../../include/config.Makefile
VPATH = @srcdir@
all::
CPPFLAGS += -I@srcdir@ -I.
YACC = bison
%.tab.c: %.y; $(YACC.y) $< $(OUTPUT_OPTION)
%.fixed.c : %.tab.c
	sed 's="bison.simple"="/usr/share/bison.simple"=' <$< >$@.tmp
	mv $@.tmp $@
LEX = flex
LFLAGS += -f -s -i
CFLAGS += -Wall -g
HSRC := buffer.h html-check-links.h getmem.h grammar.h
CSRC := html-check-links.c getmem.c buffer.c
LSRC := lex.l
YSRC := grammar.y
SRC :=  $(YSRC) $(CSRC) $(LSRC) $(HSRC)
CFILES := $(CSRC) $(LSRC:.l=.c) $(YSRC:.y=.fixed.c)
YFLAGS += -d
YFLAGS += --verbose
LOADLIBES += -lgc -ldl
ifdef FULLDEBUG
LDFLAGS := -g
CPPFLAGS += -DDEBUG
LFLAGS += -d
YFLAGS += --debug
endif
ifneq (@ETAGS@,)
all :: TAGS
endif
all:: html-check-links
%.dep : %.c; $(CC) -MM $(CPPFLAGS) $< >$@
html-check-links : $(CFILES:.c=.o)
ifneq ($(DEPENDS),no)
include $(CFILES:.c=.dep)
endif
TAGS: $(SRC); @ETAGS@ $^
lex.o : grammar.fixed.c
clean:; rm -f	*.o html-check-links *.dep y.tab.h lex.yy.c TAGS y.output \
		core grammar.c grammar.tab.* lex.c grammar.fixed.* grammar.output
distclean : clean
	rm -f Makefile
