# @configure_input@
# Targets to use:
.PHONY : all check clean distclean
ifdef XYZZY
  If you get an error message on this line, it is because you are not using
  the 'gnu' version of the 'make' program.  The source code for it is
  available at ftp://ftp.gnu.org/pub/gnu/make.
endif
include include/config.Makefile
VPATH = @srcdir@
install all clean distclean::
	@echo '-------- making '$@', $(PACKAGE_VERSION) for ARCH=$(ARCH) OS=$(OS) REL=$(REL) --------'
distclean::; rm -f config.cache config.log config.status configure.options
distclean:: clean
ifeq "$(CC)" "cl"
all:: ;	$(MAKE) -C WindowsNT
endif
all install clean :: ; $(MAKE) -C bin $@
all distclean check clean install :: ; $(MAKE) -C Macaulay2 $@
all::; $(MAKE) -C Macaulay2 doc
DIRS := $(target) $(packagedir) $(bindir)
install :: all
install :: $(DIRS)
install :: ; $(MAKE) -C encap $@
$(DIRS) :; $(INSTALL) -d $@
distribution :
	tar cf - -C $(encapdir) $(package) | gzip > Macaulay2-$(DESC).tar.gz

################################# tar manufactured files
manufactured.tgz : Makefile
	$(MAKE) -C Macaulay2/d all-c-files
	$(MAKE) -C Macaulay2/tutorial
	tar cfz $@ \
		Macaulay2/e/geovec.hpp \
		Macaulay2/e/geores.hpp \
		Macaulay2/e/cmdnames.m2 \
		Macaulay2/e/cmdnames.hpp \
		Macaulay2/e/cmdinst.hpp \
		Macaulay2/m2/tutorials.m2 \
		Macaulay2/tutorial/final/*.out \
		Macaulay2/m2/gbdoc.m2 \
		Macaulay2/m2/gbfunctions.m2 \
		Macaulay2/m2/loads.m2 \
		Macaulay2/d/*.c \
		Macaulay2/m2/cache-tmp/Examples/*.m2 \
		Macaulay2/m2/cache-tmp/Tests/*.m2 \
		Macaulay2/html
distclean ::; rm -f @CONFIGURED_FILES@ include/config.h include/config.Makefile
install all clean distclean::; @echo "-------- done making '$@' --------"
